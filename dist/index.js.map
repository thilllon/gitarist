{"version":3,"sources":["../src/github.ts"],"names":["ref","tree","path"],"mappings":"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","sourcesContent":["/* eslint-disable no-useless-escape */\n\nimport { faker } from '@faker-js/faker';\nimport { existsSync, lstatSync, mkdirSync, readFileSync, rmSync, writeFileSync } from 'fs';\nimport { readFile, rm } from 'fs/promises';\nimport _ from 'lodash';\nimport { Octokit } from 'octokit';\nimport parseGitConfig from 'parse-git-config';\nimport path from 'path';\n\nexport const branchPrefixes = ['feature', 'hotfix'] as const;\nexport const workflowStatus = [\n  'completed',\n  'action_required',\n  'cancelled',\n  'failure',\n  'neutral',\n  'skipped',\n  'stale',\n  'success',\n  'timed_out',\n  'in_progress',\n  'queued',\n  'requested',\n  'waiting',\n];\nexport const commitCategories = [\n  'feat',\n  'fix',\n  'docs',\n  'style',\n  'refactor',\n  'perf',\n  'test',\n  'chore',\n] as const;\nexport const DEFAULT = {\n  maxCommits: 3,\n  minCommits: 1,\n  maxFiles: 4,\n  minFiles: 1,\n  numberOfIssues: 2,\n  workingBranchPrefix: branchPrefixes[0],\n  mainBranch: 'main',\n  relativePath: '.gitarist',\n  remote: 'origin',\n  cron: '0 */6 * * 0-6',\n  stale: 2, // days\n  language: 'GO',\n  ownerPlaceholder: '<OWNER>',\n  repoPlaceholder: '<REPOSITORY>',\n} as const;\n\nenum MODE {\n  BLOB = '120000',\n  BLOB__FILE = '100644',\n  BLOB__EXECUTABLE = '100755',\n  TREE__DIRECTORY = '040000',\n  COMMIT__SUBMODULE = '160000',\n}\n\nexport type Language = 'GO' | 'PYTHON' | 'JAVA' | 'CPP' | 'TEXT';\nexport type SetupCommandOptions = {\n  remote: string;\n};\nexport type StartCommandOptions = {\n  owner: string;\n  repo: string;\n  token: string;\n} & {\n  minCommits: number;\n  maxCommits: number;\n  minFiles: number;\n  maxFiles: number;\n  issues: number;\n  workingBranchPrefix: BranchPrefix;\n  mainBranch: MainBranch;\n  stale: number;\n};\nexport type BranchPrefix = (typeof branchPrefixes)[number]; // TypeScript 3.4+\nexport type MainBranch = 'main' | 'master' | string;\nexport type TreeParam = {\n  path?: string | undefined;\n  mode?: MODE;\n  type?: 'blob' | 'tree' | 'commit' | undefined;\n  sha?: string | undefined;\n  content?: string | undefined;\n};\nexport type IssueItem = {\n  title: string;\n  body: string;\n  assignee?: string;\n  /**\n   * comma separated string\n   */\n  labels?: string;\n};\n\nexport class Gitarist {\n  private readonly _octokit;\n  private readonly _owner: string;\n  private readonly _repo: string;\n  private readonly _token: string;\n  private readonly labelsCandidates = [\n    {\n      name: 'enhancement',\n      color: 'a2eeef',\n      description: 'New feature or request',\n    },\n    {\n      name: 'bug',\n      color: 'd73a4a',\n      description: \"Something isn't working\",\n    },\n    {\n      name: 'documentation',\n      color: '0075ca',\n      description: 'Improvements or additions to documentation',\n    },\n    {\n      name: 'duplicate',\n      color: 'cfd3d7',\n      description: 'This issue or pull request already exists',\n    },\n  ];\n  private assigneeCandidates: string[] = [];\n  private languageMap: Record<Language, { ext: string; comment: string }> = {\n    GO: { ext: 'go', comment: '//' },\n    PYTHON: { ext: 'py', comment: '#' },\n    JAVA: { ext: 'java', comment: '//' },\n    CPP: { ext: 'cc', comment: '//' },\n    TEXT: { ext: 'txt', comment: '' },\n  };\n\n  constructor({ owner, repo, token }: { owner: string; repo: string; token: string }) {\n    this._owner = owner;\n    this._repo = repo;\n    this._token = token;\n\n    if (!this._owner) {\n      throw new Error('Missing environment variable: \"GITHUB_OWNER\"');\n    }\n\n    if (!this._repo) {\n      throw new Error('Missing environment variable: \"GITHUB_REPO\"');\n    }\n\n    if (!this._token) {\n      throw new Error('Missing environment variable: \"GITHUB_TOKEN\"');\n    }\n\n    this._octokit = new Octokit({ auth: this._token });\n    this.assigneeCandidates = [this._owner];\n  }\n\n  get owner() {\n    return this._owner;\n  }\n\n  get repo() {\n    return this._repo;\n  }\n\n  get octokit(): Octokit {\n    return this._octokit;\n  }\n\n  static get logo() {\n    return `\n          _ __             _      __ \n   ____ _(_) /_____ ______(_)____/ /_\n  / __ \\`/ / __/ __ \\`/ ___/ / ___/ __/\n / /_/ / / /_/ /_/ / /  / (__  ) /_\n \\__, /_/\\__/\\__,_/_/  /_/____/\\__/\n/____/ \n`;\n  }\n\n  static get tokenIssueUrl() {\n    return 'https://github.com/settings/tokens/new?description=GITHUB_TOKEN&scopes=repo,read:packages,read:org,delete_repo,workflow';\n  }\n\n  static getEnvSettingPageUrl({ owner, repo }: { owner: string; repo: string }) {\n    return `https://github.com/${owner}/${repo}/settings/secrets/actions/new`;\n  }\n\n  /**\n   * Create a github action file\n   * @example '0 \\*\\/4 \\* \\* 0-6' means 'for every N hours Sunday to Saturday'\n   */\n  static getActionTemplate({\n    cron = DEFAULT.cron,\n    repo = '<REPO>',\n    owner = '<USERNAME>',\n  }: {\n    cron?: string;\n    repo?: string;\n    owner?: string;\n  }) {\n    const template = `\n    \nname: Gitarist\n\non: \n  workflow_dispatch:\n  schedule:\n    - cron: '${cron}'\n\njobs:\n  start:\n    runs-on: ubuntu-latest\n    env:\n      GITHUB_OWNER: \\${{ github.repository_owner }}\n      GITHUB_REPO: \\${{ github.event.repository.name }}\n      # Create a secret key at,\n      # ${this.tokenIssueUrl}\n      # and register the secret key to action settings at,\n      # ${Gitarist.getEnvSettingPageUrl({ owner, repo })}\n      GITHUB_TOKEN: \\${{ secrets.GITHUB_TOKEN }}\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npx gitarist start\n`;\n\n    return template;\n  }\n\n  /**\n   * Create the .env file\n   * @param owner\n   * @param repo\n   * @param token\n   * @returns\n   */\n  static getEnvTemplate({ owner = '', repo = '', token = '' }) {\n    const template = `\n# gitarist    \nGITHUB_OWNER=\"${owner}\"\nGITHUB_REPO=\"${repo}\"\n# ${Gitarist.tokenIssueUrl}\nGITHUB_TOKEN=\"${token}\"\n`;\n\n    return template;\n  }\n\n  /**\n   * Setup a repository for gitarist which is creating a workflow file.\n   */\n  static async setup({ remote = DEFAULT.remote }: Partial<SetupCommandOptions>) {\n    const gitConfigPath = path.join(process.cwd(), '.git', 'config');\n    if (!existsSync(gitConfigPath)) {\n      throw new Error(\n        `Could not find git config file from this directory, ${gitConfigPath}. This is not a git repository. Maybe you should run \"git init\" first.`,\n      );\n    }\n\n    const dotenvFile = '.env';\n    const envPath = path.join(process.cwd(), dotenvFile);\n    console.log(`Searching ${dotenvFile} file from ${envPath} ...`);\n    if (existsSync(envPath)) {\n      console.log(\n        `\\tThere is a ${dotenvFile} file already so template will be appended to the file.`,\n      );\n    } else {\n      console.log(`\\tCould not find a ${dotenvFile} file`);\n    }\n\n    const ymlPath = path.join(process.cwd(), '.github', 'workflows', 'gitarist.yml');\n    console.log(`Searching gitarist workflow file from ${envPath} ...`);\n    if (existsSync(ymlPath)) {\n      console.log(`\\tThere is a gitarist workflow file already at ${ymlPath}.`);\n    } else {\n      console.log(`\\tCould not find a workflow file`);\n    }\n\n    const git = parseGitConfig.sync(\n      readFileSync(path.join(process.cwd(), '.git', 'config'), 'utf8'),\n    );\n    const owner = git?.user?.name ?? DEFAULT.ownerPlaceholder;\n    const repo =\n      git[`remote \"${remote}\"`]?.url?.split('/')?.pop()?.replace('.git', '').replace('/', '') ??\n      DEFAULT.repoPlaceholder;\n    const githubWorkflowDirectory = path.join(process.cwd(), '.github', 'workflows');\n    mkdirSync(githubWorkflowDirectory, { recursive: true });\n    writeFileSync(\n      path.join(githubWorkflowDirectory, 'gitarist.yml'),\n      Gitarist.getActionTemplate({ owner, repo }),\n      { encoding: 'utf8', flag: 'a+' },\n    );\n    writeFileSync(path.join(process.cwd(), '.env'), Gitarist.getEnvTemplate({ owner, repo }), {\n      encoding: 'utf8',\n      flag: 'a+',\n    });\n\n    console.log(['Generate a secret key settings:', Gitarist.tokenIssueUrl].join('\\n'));\n    // Open the browser to create a secret key\n    const open = await import('open');\n    await open.default(Gitarist.tokenIssueUrl, { wait: false });\n    const envSettingPageUrl = Gitarist.getEnvSettingPageUrl({ owner, repo });\n    console.log(`Register the secret key to action settings: ${envSettingPageUrl}`);\n    console.log(\n      'Go to repository > settings > Secrets and variables > Actions > New repository secret',\n    );\n\n    if (owner !== DEFAULT.ownerPlaceholder) {\n      console.error(`It is unable to find git username`);\n      return;\n    }\n\n    if (repo !== DEFAULT.repoPlaceholder) {\n      console.error(`It is unable to find repository name.`);\n      return;\n    }\n\n    await open.default(Gitarist.tokenIssueUrl, { wait: false });\n    await open.default(envSettingPageUrl, { wait: false });\n  }\n\n  /**\n   * create a commit\n   * make a pull request\n   * review it\n   * merge it\n   */\n  async simulateActiveUser({\n    maxCommits = DEFAULT.maxCommits,\n    minCommits = DEFAULT.minCommits,\n    maxFiles = DEFAULT.maxFiles,\n    minFiles = DEFAULT.minFiles,\n    numberOfIssues = DEFAULT.numberOfIssues,\n    workingBranchPrefix = DEFAULT.workingBranchPrefix,\n    mainBranch = DEFAULT.mainBranch,\n    stale = DEFAULT.stale,\n    language = DEFAULT.language,\n  }: {\n    maxCommits?: number;\n    minCommits?: number;\n    maxFiles?: number;\n    minFiles?: number;\n    numberOfIssues?: number;\n    workingBranchPrefix?: BranchPrefix; // prefix of current working branch\n    mainBranch?: MainBranch; // merge target branch\n    stale?: number;\n    language?: Language;\n  }) {\n    for (const key of Array(numberOfIssues).keys()) {\n      console.debug(`issue: ${key + 1}/${numberOfIssues}`);\n      await this.createCommitAndMakePullRequest({\n        numberOfCommits: _.sample(_.range(minCommits, maxCommits + 1)) as number,\n        numberOfFiles: _.sample(_.range(minFiles, maxFiles + 1)) as number,\n        workingBranchPrefix,\n        mainBranch,\n        language,\n      });\n    }\n\n    const olderThan = new Date(Date.now() - stale * 86400 * 1000);\n    await this.deleteOldWorkflowLogs({ olderThan });\n    await this.deleteOldFiles({ olderThan, mainBranch });\n    await this.resolveAllReviewComments();\n    await this.deleteOldIssues({ olderThan });\n    await this.deleteCommentsAtIssueByBot();\n    await this.deleteBranches({ ref: `heads/${workingBranchPrefix}` });\n    await this.closeStaleIssues({ olderThan });\n  }\n\n  async closeStaleIssues({ olderThan }: { olderThan: Date }) {\n    // close issues that are older than the specified date\n    for await (const { data: issues } of this.octokit.paginate.iterator(\n      this.octokit.rest.issues.listForRepo,\n      {\n        owner: this.owner,\n        repo: this.repo,\n        per_page: 100,\n        sort: 'created',\n        direction: 'desc',\n      },\n    )) {\n      for (const issue of issues) {\n        if (new Date(issue.created_at).getTime() < new Date(olderThan).getTime()) {\n          await this.octokit.rest.issues.update({\n            owner: this.owner,\n            repo: this.repo,\n            issue_number: issue.number,\n            state: 'closed',\n          });\n        }\n      }\n    }\n  }\n\n  async deleteOldIssues({ olderThan }: { olderThan: Date }) {\n    for await (const { data: issues } of this.octokit.paginate.iterator(\n      this.octokit.rest.issues.listForRepo,\n      {\n        owner: this.owner,\n        repo: this.repo,\n        per_page: 100,\n        sort: 'created',\n        direction: 'desc',\n      },\n    )) {\n      for (const issue of issues) {\n        if (issue.pull_request?.url) {\n          // if the issue is a PR, then deletion is prohibited\n          continue;\n        }\n\n        if (new Date(issue.created_at).getTime() < new Date(olderThan).getTime()) {\n          const query = `\n          mutation DeleteIssue($input: DeleteIssueInput!) {\n            deleteIssue(input: $input) {\n              repository {\n                name\n              }\n            }\n          }\n        `;\n          try {\n            const result = await this.octokit.graphql(query, {\n              input: {\n                issueId: issue.node_id,\n              },\n            });\n            console.debug(result, issue.pull_request?.url);\n          } catch (error: any) {\n            // try-catch를 써야하는 이유는 다음과 같다. 깃헙은 이슈와 PR이 연동되어있다. 이슈에서 PR을 생성한 경우 이슈가 PR로 넘어가게되며 이슈는 더이상 삭제할 수 없게된다. 그리고 삭제 시도시 에러가 발생한다.\n            console.debug(error?.message, issue.pull_request?.url);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * ref와 부분일치하는 브랜치\n   * @example 'heads/feat' 이걸로 시작하는 모든 브랜치 삭제\n   */\n  async listBranches({ ref }: { ref: string }) {\n    const { data: branches } = await this.octokit.rest.git.listMatchingRefs({\n      owner: this.owner,\n      repo: this.repo,\n      ref,\n    });\n    console.debug(`branche names starts with ${ref}: [${branches.map(({ ref }) => ref).join()}]`);\n    return branches;\n  }\n\n  /**\n   * ref와 부분일치하는 브랜치\n   * @example 'heads/feat' 이걸로 시작하는 모든 브랜치 삭제\n   */\n  async deleteBranches({\n    ref,\n    mainBranch = DEFAULT.mainBranch,\n  }: {\n    ref: string;\n    mainBranch?: MainBranch;\n  }) {\n    const { data: refs } = await this.octokit.rest.git.listMatchingRefs({\n      owner: this.owner,\n      repo: this.repo,\n      ref,\n    });\n\n    console.debug(`branche names starts with ${ref}: [${refs.map(({ ref }) => ref).join()}]`);\n\n    for (let { ref } of refs) {\n      if (ref.startsWith('refs/heads/')) {\n        ref = ref.replace('refs/', '');\n      }\n\n      console.debug(`delete branch. ref: ${ref}`);\n\n      await this.octokit.rest.git.updateRef({\n        owner: this.owner,\n        repo: this.repo,\n        sha: '', // empty SHA denotes deletion of the branch\n        ref: `heads/${mainBranch}`,\n      });\n    }\n  }\n\n  async deleteFolder({\n    folderPaths,\n    relative,\n  }: {\n    folderPaths: string[];\n    /**\n     * if true, then folderPaths are relative paths from the current working directory(process.cwd())\n     */\n    relative?: boolean;\n  }) {\n    if (relative) {\n      folderPaths = folderPaths.map((folderPath) => path.join(process.cwd(), folderPath));\n    }\n\n    for (const folderPath of folderPaths) {\n      if (!existsSync(folderPath) || !lstatSync(folderPath).isDirectory()) {\n        continue;\n      }\n      console.warn(`delete folder. folderPath: ${folderPath}`);\n      rmSync(folderPath, { recursive: true, force: true });\n    }\n  }\n\n  async deleteCommentsAtIssueByBot() {\n    for await (const issue of await this.octokit.paginate(this.octokit.rest.issues.list, {\n      owner: this.owner,\n      repo: this.repo,\n      filter: 'all',\n    })) {\n      for await (const comment of await this.octokit.paginate(\n        this.octokit.rest.issues.listComments,\n        {\n          owner: this.owner,\n          repo: this.repo,\n          issue_number: issue.number,\n          per_page: 100,\n        },\n      )) {\n        if (comment.user?.login?.includes('[bot]')) {\n          console.debug(`remove comment issue. issue: ${issue.number}, comment: ${comment.id}`);\n          await this.octokit.rest.issues.deleteComment({\n            owner: this.owner,\n            repo: this.repo,\n            comment_id: comment.id,\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * 현재 프로젝트에서 일정 기간이 지난 파일을 삭제한다. 실제 파일이 로컬에서 삭제되는게 중요한게 아니라 깃에서 삭제되는게 중요하다.\n   */\n  async deleteOldFiles({\n    olderThan,\n    mainBranch = DEFAULT.mainBranch,\n  }: {\n    olderThan: Date;\n    mainBranch?: MainBranch;\n  }): Promise<void> {\n    console.debug('start to delete old files');\n    const { data: branchRef } = await this.octokit.rest.git.getRef({\n      owner: this.owner,\n      repo: this.repo,\n      ref: `heads/${mainBranch}`,\n    });\n    const latestCommitSha = branchRef.object.sha; // Get the latest commit SHA of the branch\n\n    const { data: currentTree } = await this.octokit.rest.git.getTree({\n      owner: this.owner,\n      repo: this.repo,\n      tree_sha: latestCommitSha,\n      recursive: 'true',\n    });\n    const targetFilePaths = currentTree.tree\n      .filter((file) => {\n        const fullPath = path.join(process.cwd(), file.path ?? '');\n        const createdAt = new Date(Number.parseInt(path.basename(fullPath))).getTime();\n        const flag =\n          file.type === 'blob' &&\n          file.path?.startsWith(`${DEFAULT.relativePath}/`) &&\n          !isNaN(createdAt) &&\n          createdAt < new Date(olderThan).getTime();\n        return flag;\n      })\n      .map((tree) => {\n        console.debug(`will be deleted. ${tree.path}}`);\n        return tree.path;\n      });\n\n    if (targetFilePaths.length === 0) {\n      return;\n    }\n\n    // Create a tree object with the file deletion\n    const { data: tree } = await this.octokit.rest.git.createTree({\n      owner: this.owner,\n      repo: this.repo,\n      base_tree: latestCommitSha,\n      tree: targetFilePaths.map((path) => ({\n        path,\n        type: 'tree',\n        mode: MODE.BLOB__FILE,\n        sha: null, // To indicate file deletion\n      })),\n    });\n\n    const newTreeSha = tree.sha;\n\n    // Create a new commit object referencing the new tree and the previous commit\n    const { data: newCommit } = await this.octokit.rest.git.createCommit({\n      owner: this.owner,\n      repo: this.repo,\n      message: 'feat: clean up stale files',\n      tree: newTreeSha,\n      parents: [latestCommitSha],\n    });\n\n    // Update the branch reference to point to the new commit\n    const { data: pushed } = await this.octokit.rest.git.updateRef({\n      owner: this.owner,\n      repo: this.repo,\n      ref: `heads/${mainBranch}`,\n      sha: newCommit.sha,\n    });\n    console.debug(`commit pushed. sha: ${pushed.object.sha}`);\n  }\n\n  async createIssuesFromJson({ relativePath }: { relativePath: string }) {\n    const data = await readFile(path.join(process.cwd(), relativePath), 'utf8');\n\n    try {\n      const issueItems = JSON.parse(data);\n      this.validateIssueTemplate(issueItems);\n      await this.createMultipleIssues({ issueItems });\n    } catch (error: any) {\n      console.error(error.message);\n    }\n  }\n\n  async createMultipleIssues({ issueItems }: { issueItems: IssueItem[] }) {\n    for (const item of issueItems) {\n      const { data: issue } = await this.octokit.rest.issues.create({\n        owner: this.owner,\n        repo: this.repo,\n        title: item.title,\n        body: item.body,\n        labels: item.labels?.split(',').map((label) => label.trim()),\n      });\n      if (!item.assignee) {\n        continue;\n      }\n      const { status } = await this.octokit.rest.issues.checkUserCanBeAssigned({\n        owner: this.owner,\n        repo: this.repo,\n        assignee: item.assignee,\n      });\n      if (status !== 204) {\n        continue;\n      }\n      await this.octokit.rest.issues.addAssignees({\n        repo: this.repo,\n        owner: this.owner,\n        issue_number: issue.number,\n        assignees: [item.assignee],\n      });\n    }\n  }\n\n  /**\n   * 과금되고 있는 github action을 감지한다.\n   */\n  async findWastedActionsOverAllRepositories() {\n    for await (const { data: repositories } of this.octokit.paginate.iterator(\n      this.octokit.rest.repos.listForAuthenticatedUser,\n      {\n        username: this.owner,\n      },\n    )) {\n      for (const { name } of repositories) {\n        for await (const { data: workflows } of this.octokit.paginate.iterator(\n          this.octokit.rest.actions.listRepoWorkflows,\n          {\n            owner: this.owner,\n            repo: name,\n          },\n        )) {\n          for (const workflow of workflows) {\n            /**\n             * Github workflow ID can be found in url.\n             * @example if the action url is https://github.com/<owner>/<repo>/actions/workflows/build-and-test.yml, then \"build-and-test.yml\" is workflow id'\n             */\n            const usages = await this.octokit.rest.actions.getWorkflowUsage({\n              owner: this.owner,\n              repo: name,\n              workflow_id: workflow.id,\n            });\n            let data = {\n              repo: name,\n              workflowName: workflow.name,\n            };\n            if (usages.data.billable.UBUNTU) {\n              data = { ...data, ...usages.data.billable.UBUNTU };\n            }\n            if (usages.data.billable.MACOS) {\n              data = { ...data, ...usages.data.billable.MACOS };\n            }\n            if (usages.data.billable.WINDOWS) {\n              data = { ...data, ...usages.data.billable.WINDOWS };\n            }\n          }\n        }\n      }\n    }\n  }\n\n  async resolveAllReviewComments() {\n    const MAX_ITERATION = 10;\n    let iter = 0;\n    let nextPullRequestCursor = null;\n    let threadAfter = null;\n\n    const listPullRequestsAndReviewThreadsQuery = `\n      query ListRepos(\n        $owner: String!\n        $repo: String!\n        $pullRequestFirst: Int!\n        $threadFirst: Int!\n        $pullRequestAfter: String\n        $threadAfter: String\n      ) {\n        repository(owner: $owner, name: $repo) {\n          pullRequests(\n            first: $pullRequestFirst\n            after: $pullRequestAfter\n            orderBy: { field: CREATED_AT, direction: DESC }\n          ) {\n            edges {\n              cursor\n              node {\n                number\n                mergeable\n                reviewThreads(first: $threadFirst, after: $threadAfter) {\n                  edges {\n                    node {\n                      id\n                      isResolved\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    `;\n\n    const resolvedThreadIds: string[] = [];\n    // TODO: convert to octokit.graphql.paginate rather than MAX_ITERATION\n    while (iter++ < MAX_ITERATION) {\n      const queryResult: any = await this.octokit\n        .graphql(listPullRequestsAndReviewThreadsQuery, {\n          owner: this.owner,\n          repo: this.repo,\n          pullRequestFirst: 10,\n          pullRequestAfter: nextPullRequestCursor, // cursor, base64 encoded string\n          threadFirst: 10,\n          threadAfter, // cursor, base64 encoded string\n        })\n        .catch((error: any) => {\n          console.error(error.message);\n        });\n\n      if (!queryResult) {\n        continue;\n      }\n\n      // edge는 pull request의 필드이름일뿐으로 다른의미는 없는 걸로 보임\n      const edges = queryResult.repository.pullRequests.edges;\n\n      if (edges?.length > 0) {\n        if (typeof edges[0].node.number === 'number') {\n          // console.debug(`pull requests: [${edges.join()}]`);\n        }\n        if (typeof edges[0] === 'number') {\n          // console.debug(`pull requests: [${edges.join()}]`);\n        }\n      }\n      // console.debug(`pull requests: [${edges.join()}]`);\n\n      const unresolvedThreads = edges\n        .map((edge: any) => edge.node.reviewThreads.edges.map(({ node }: any) => node))\n        .flat()\n        .filter((node: any) => node && !node.isResolved);\n      const unresolvedThreadIds = unresolvedThreads.map((node: any) => node.id);\n\n      console.debug(\n        `unresolvedThreadIds(total: ${\n          unresolvedThreadIds.length\n        }): [${unresolvedThreadIds.join()}]`,\n      );\n\n      const resolveReviewThreadMutation = `\n        mutation ResolveReviewThread($input: ResolveReviewThreadInput!) {\n          resolveReviewThread(input: $input) {\n            thread {\n              id\n            }\n          } \n        }\n      `;\n\n      const mutationResultList: any[] = [];\n\n      for (const threadId of unresolvedThreadIds) {\n        let hasError = false;\n        await this.octokit\n          .graphql(resolveReviewThreadMutation, {\n            input: {\n              threadId,\n            },\n          })\n          .then((response: any) => {\n            console.debug(`resolved thread. threadId: ${threadId}`);\n            resolvedThreadIds.push(threadId);\n            mutationResultList.push(response);\n          })\n          .catch((error: any) => {\n            console.error(error?.response?.data?.error);\n            console.error(error.message);\n            hasError = true;\n          });\n\n        if (hasError) {\n          break;\n        }\n      }\n\n      // 2개의 반복문으로 이루어져있음.\n      // 1. pull request에 대한 반복이 외부 반복문\n      // 2. comments thread에 대한 반복이 내부 반복문\n      if (unresolvedThreads.length === 0) {\n        threadAfter = null;\n        nextPullRequestCursor = edges[edges.length - 1]?.cursor ?? null;\n      } else {\n        threadAfter = unresolvedThreads[unresolvedThreads.length - 1]?.id ?? null;\n      }\n      if (edges.length === 0) {\n        break;\n      }\n    }\n\n    return resolvedThreadIds;\n  }\n\n  /**\n   * change pull request title and body\n   */\n  async changePullRequestData() {\n    for await (const { data: pullRequests } of this.octokit.paginate.iterator(\n      this.octokit.rest.pulls.list,\n      {\n        repo: this.repo,\n        owner: this.owner,\n        base: DEFAULT.mainBranch,\n        state: 'closed',\n        per_page: 100,\n        sort: 'created',\n      },\n    )) {\n      for (const pullRequest of pullRequests) {\n        const isTarget = false;\n\n        throw new Error('Write custom target condition when you are running this script!');\n\n        if (!isTarget) {\n          continue;\n        }\n        const pullRequestNumber = pullRequest.number;\n        console.debug(`change pull request. pull request: #${pullRequest.number}`);\n        await this.octokit.rest.pulls.update({\n          owner: this.owner,\n          repo: this.repo,\n          pull_number: pullRequestNumber,\n          title: `[${_.sample(commitCategories)}] ${faker.lorem.sentences(1)}`,\n          body: faker.lorem.paragraphs(10),\n        });\n      }\n    }\n  }\n\n  async deleteOldWorkflowLogs({ olderThan }: { olderThan: Date }) {\n    const deleteWorkflowStatus = [\n      'completed',\n      'action_required',\n      'cancelled',\n      'failure',\n      'neutral',\n      'skipped',\n      'success',\n      'timed_out',\n      'waiting',\n    ];\n\n    for await (const workflow of await this.octokit.paginate(\n      this.octokit.rest.actions.listRepoWorkflows,\n      {\n        owner: this.owner,\n        repo: this.repo,\n        per_page: 100,\n      },\n    )) {\n      for await (const run of await this.octokit.paginate(\n        this.octokit.rest.actions.listWorkflowRuns,\n        {\n          owner: this.owner,\n          repo: this.repo,\n          workflow_id: workflow.id,\n        },\n      )) {\n        if (\n          !(\n            new Date(run.created_at) < new Date(olderThan) &&\n            deleteWorkflowStatus.includes(run.status ?? '')\n          )\n        ) {\n          continue;\n        }\n        await this.octokit.rest.actions\n          .deleteWorkflowRun({\n            owner: this.owner,\n            repo: this.repo,\n            run_id: run.id,\n          })\n          .then(() => console.debug(`delete workflow run. runId: ${run.id}`))\n          .catch((error: any) => {\n            console.error(error.message);\n          });\n\n        await this.octokit.rest.actions\n          .deleteWorkflowRunLogs({\n            owner: this.owner,\n            repo: this.repo,\n            run_id: run.id,\n          })\n          .then(() => console.debug(`delete workflow run logs. runId: ${run.id}`))\n          .catch((error: any) => {\n            console.error(error.message);\n          });\n      }\n    }\n  }\n\n  private async createCommitAndMakePullRequest({\n    numberOfCommits,\n    numberOfFiles,\n    mainBranch: targetBranch,\n    workingBranchPrefix,\n    language,\n  }: {\n    numberOfCommits: number;\n    numberOfFiles: number;\n    mainBranch: MainBranch;\n    workingBranchPrefix: BranchPrefix;\n    language: Language;\n  }): Promise<number> {\n    const relativePath = DEFAULT.relativePath;\n\n    const { data: issue } = await this.octokit.rest.issues.create({\n      owner: this.owner,\n      repo: this.repo,\n      title: `[${_.sample<any>(commitCategories)}] ${faker.lorem.sentences(1)}`,\n      body: faker.lorem.paragraphs(10),\n      assignees: [_.sample<any>(this.assigneeCandidates)],\n    });\n    console.debug(`create an issue #${issue.number}`);\n\n    const label = _.sample<any>(this.labelsCandidates);\n    const { data: labels } = await this.octokit.rest.issues.listLabelsForRepo({\n      owner: this.owner,\n      repo: this.repo,\n    });\n    if (labels.every(({ name }) => name !== label.name)) {\n      await this.octokit.rest.issues.createLabel({\n        owner: this.owner,\n        repo: this.repo,\n        ...label,\n      });\n    }\n    await this.octokit.rest.issues.addLabels({\n      issue_number: issue.number,\n      owner: this.owner,\n      repo: this.repo,\n      labels: [label.name],\n    });\n\n    console.debug(`comment on issues #${issue.number}`);\n    await this.octokit.rest.issues.createComment({\n      owner: this.owner,\n      repo: this.repo,\n      body: faker.lorem.sentences(10),\n      issue_number: issue.number,\n    });\n\n    let createdFilePathList: string[] = [];\n\n    // get target branch's latest commit SHA and its tree's SHA\n    const { data: targetRef } = await this.octokit.rest.git.getRef({\n      owner: this.owner,\n      repo: this.repo,\n      ref: `heads/${targetBranch}`,\n    });\n\n    // Create a new branch based on the latest commit SHA of the base branch\n    const mainBranch = `${workingBranchPrefix}/issue-${issue.number}`;\n    console.debug(`create a new branch. refs/heads/${mainBranch}`);\n    await this.octokit.rest.git.createRef({\n      owner: this.owner,\n      repo: this.repo,\n      ref: `refs/heads/${mainBranch}`,\n      sha: targetRef.object.sha,\n    });\n\n    for (const commitCount of Array(numberOfCommits).keys()) {\n      console.debug(`start to create a commit... (${commitCount + 1}/${numberOfCommits})`);\n\n      console.debug(`create files. number of files: ${numberOfFiles}`);\n      createdFilePathList = this.createFiles({\n        numberOfFiles,\n        relativePath,\n        language,\n      });\n\n      // 해당 브랜치에 여러개의 파일 추가\n      // 실제 파일의 폴더구조는 무시하고 깃에 포함시킬 파일의 폴더구조를 tree로 정의할 수 있다. 실제 파일은 전혀 다른 경로에 있어도 깃에는 특정 경로에 파일이 들어가도록 할 수 있다.\n      const tree: TreeParam[] = [];\n      // for (const filePath of FastGlob.glob.sync([`${relativePath}/*`], { absolute: false })) { }\n      for (const filePath of createdFilePathList) {\n        console.debug(`a file created. ${filePath}`);\n        const { data: blob } = await this.octokit.rest.git.createBlob({\n          owner: this.owner,\n          repo: this.repo,\n          content: readFileSync(filePath, 'utf8'),\n          encoding: 'utf-8',\n        });\n        tree.push({\n          path: `${relativePath}/${path.basename(filePath)}`,\n          sha: blob.sha,\n          mode: MODE.BLOB__FILE,\n          type: 'blob',\n        });\n      }\n\n      // get latest commit SHA\n      const { data: latestCommit } = await this.octokit.rest.git.getCommit({\n        owner: this.owner,\n        repo: this.repo,\n        commit_sha: targetRef.object.sha,\n      });\n\n      // create a tree by attaching files based on the target branch's latest commit\n      console.debug(`create a tree. base tree: ${latestCommit.tree.sha}`);\n      const { data: newTree } = await this.octokit.rest.git.createTree({\n        owner: this.owner,\n        repo: this.repo,\n        tree,\n        base_tree: latestCommit.tree.sha,\n      });\n\n      const parents = [targetRef.object.sha];\n      console.debug(`tree created. parents: [${parents.join()}]`);\n      const { data: newCommit } = await this.octokit.rest.git.createCommit({\n        owner: this.owner,\n        repo: this.repo,\n        message: `${_.sample<any>(commitCategories)}: ${faker.lorem.sentences(1)}`,\n        tree: newTree.sha,\n        parents,\n      });\n\n      // git push (THE MOST IMPORTANT PART)\n      console.debug(`push the commit. ${newCommit.sha}`);\n      await this.octokit.rest.git.updateRef({\n        owner: this.owner,\n        repo: this.repo,\n        ref: `heads/${mainBranch}`,\n        sha: newCommit.sha,\n        force: true,\n      });\n    }\n\n    await this.createPullRequestAndReviewAndMerge({\n      baseBranch: targetBranch,\n      headBranch: `refs/heads/${mainBranch}`,\n      issue: issue.number,\n      commentTargetFilePath: `${relativePath}/${path.basename(createdFilePathList[0])}`, // first file path is used for comment\n    });\n\n    console.debug(`delete the source branch. heads/${mainBranch}`);\n    await this.octokit.rest.git\n      .deleteRef({\n        owner: this.owner,\n        repo: this.repo,\n        ref: `heads/${mainBranch}`, // `heads/<branch_name>` or simply `<branch_name>`\n      })\n      .catch((error: any) => {\n        // throws an error if \"Automatically delete head branch\" settins is enabled\n        console.error(error.message);\n      });\n\n    // leave a comment after merge\n    await this.octokit.rest.issues.createComment({\n      owner: this.owner,\n      repo: this.repo,\n      body: faker.lorem.sentences(10),\n      issue_number: issue.number,\n    });\n\n    // clean files up\n    await rm(path.join(process.cwd(), relativePath), {\n      recursive: true,\n      force: true,\n      maxRetries: 10,\n    }).catch((error: any) => {\n      console.error(error.message);\n    });\n    return issue.number;\n  }\n\n  private validateIssueTemplate(issues: IssueItem[]) {\n    issues.forEach((issue, index) => {\n      if (!issue.title) {\n        throw new Error(`[createIssuesFromJson][index: ${index}] Missing field: title`);\n      }\n      if (!issue.body) {\n        throw new Error(`[createIssuesFromJson][index: ${index}] Missing field: body`);\n      }\n      if (issue.assignee === '') {\n        throw new Error(`[createIssuesFromJson][index: ${index}] Invalid field: assignee`);\n      }\n    });\n  }\n\n  private async createPullRequestAndReviewAndMerge({\n    baseBranch,\n    headBranch,\n    issue,\n    commentTargetFilePath,\n  }: {\n    baseBranch: string;\n    headBranch: string;\n    issue: number;\n    commentTargetFilePath: string;\n  }) {\n    console.debug(`base branch: refs/heads/${baseBranch}`);\n    console.debug(`head branch: ${headBranch}`);\n\n    const { data: pullRequest } = await this.octokit.rest.pulls.create({\n      owner: this.owner,\n      repo: this.repo,\n      base: baseBranch,\n      head: headBranch,\n      issue,\n      body: faker.lorem.paragraphs(10),\n      draft: false,\n    });\n\n    if (!pullRequest) {\n      console.error('pull request is not found');\n      return;\n    }\n\n    const { data: reviewCommented } = await this.octokit.rest.pulls.createReview({\n      owner: this.owner,\n      repo: this.repo,\n      pull_number: pullRequest.number,\n      event: 'COMMENT',\n      comments: [\n        {\n          path: commentTargetFilePath,\n          body: faker.lorem.sentences(3),\n          line: 1,\n        },\n      ],\n    });\n\n    const reviewerCandidates = await this.octokit.rest.repos.listCollaborators({\n      owner: this.owner,\n      repo: this.repo,\n      permission: 'maintain',\n    });\n    const reviewrs = reviewerCandidates.data\n      .map((user) => user.login)\n      .filter((login) => login !== this.owner);\n\n    console.debug(`reviewer candidates: [${reviewrs.join()}]`);\n    if (reviewrs.length === 0) {\n      console.debug('Review by author is not allowed. No reviewer is assigned.');\n    } else {\n      // when a number of reviewer candidates is greater than 1\n      await this.octokit.rest.pulls.requestReviewers({\n        owner: this.owner,\n        repo: this.repo,\n        pull_number: pullRequest.number,\n        reviewers: [_.sample<any>(reviewrs)],\n      });\n\n      await this.octokit.rest.pulls.createReview({\n        owner: this.owner,\n        repo: this.repo,\n        pull_number: pullRequest.number,\n        event: 'APPROVE',\n        comments: [{ path: commentTargetFilePath, body: 'LGTM', line: 1 }],\n      });\n\n      await this.octokit.rest.pulls.submitReview({\n        owner: this.owner,\n        repo: this.repo,\n        pull_number: pullRequest.number,\n        event: 'APPROVE',\n        review_id: reviewCommented.id,\n      });\n\n      await this.octokit.rest.pulls.updateReview({\n        owner: this.owner,\n        repo: this.repo,\n        pull_number: pullRequest.number,\n        review_id: reviewCommented.id,\n        body: 'viewed',\n      });\n    }\n\n    const listPullRequestsAndReviewThreadsQuery = `\n      query ListRepos($owner: String!, $repo: String!, $pullRequestLast: Int!, $threadLast: Int!) {\n        repository(owner: $owner, name: $repo) {\n          pullRequests(last: $pullRequestLast, orderBy: { field: CREATED_AT, direction: DESC }) {\n            edges {\n              cursor\n              node {\n                number\n                mergeable\n                reviewThreads(last: $threadLast) {\n                  edges {\n                    node {\n                      id\n                      isResolved\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    `;\n\n    // 이슈에서 연동된 PR이라서 검색이 안되는걸로 보임...\n    const queryResult: any = await this.octokit.graphql(listPullRequestsAndReviewThreadsQuery, {\n      owner: this.owner,\n      repo: this.owner,\n      pullRequestLast: 100,\n      threadLast: 100,\n    });\n\n    const edges = queryResult.repository.pullRequests.edges;\n    console.debug(`pull requests: [${edges.join()}]`);\n\n    const threadIds = edges\n      .map((edge: any) => edge.node.reviewThreads.edges.map(({ node }: any) => node))\n      .flat()\n      .filter((node: any) => node && !node.isResolved)\n      .map((node: any) => node.id);\n\n    console.debug(`threadsIds:[${threadIds.join()}]`);\n\n    const resolveReviewThreadMutation = `\n      mutation ResolveReviewThread($input: ResolveReviewThreadInput!) {\n        resolveReviewThread(input: $input) {\n          thread {\n            id\n          }\n        }\n      }\n    `;\n    for (const threadId of threadIds) {\n      const mutationResult = await this.octokit.graphql(resolveReviewThreadMutation, {\n        input: {\n          threadId,\n        },\n      });\n      console.debug(mutationResult);\n    }\n\n    // merge pull request\n    const { data: mergeResult } = await this.octokit.rest.pulls.merge({\n      owner: this.owner,\n      repo: this.repo,\n      pull_number: pullRequest.number,\n      merge_method: 'squash',\n    });\n    console.debug(`merged. ${mergeResult.sha} ${mergeResult.message}`);\n  }\n\n  private createFiles({\n    numberOfFiles,\n    relativePath,\n    language,\n  }: {\n    numberOfFiles: number;\n    relativePath: string;\n    language: Language;\n  }) {\n    const directoryPath = path.join(process.cwd(), relativePath);\n    if (!existsSync(directoryPath)) {\n      mkdirSync(directoryPath, { recursive: true });\n    }\n\n    return Array.from({ length: numberOfFiles })\n      .map(() => {\n        try {\n          const filePath = path.join(\n            directoryPath,\n            `${Date.now().toString()}.${this.languageMap[language].ext}`,\n          );\n          writeFileSync(filePath, faker.lorem.paragraphs(10), {\n            encoding: 'utf8',\n            flag: 'a+',\n          });\n          return filePath;\n        } catch (error) {\n          console.error(error);\n          return '';\n        }\n      })\n      .filter(Boolean);\n  }\n}\n"]}